# Translations

Application translations are managed via usage of `message.Printer.PrintF(),
Fprintf() and Sprintf()`, `gotext` and `go generate` via the method outlined in
[This awesome Alex Edward article](https://www.alexedwards.net/blog/i18n-managing-translations).
The gist is that text is formatted in strings using `fmt.Sprint` and those messages
are detected when running a command to create `out.gotext.json` files for each
locale the apps should care about.  These can then be translated into their source
langauges and then copied back into their source locale directories as
`messages.gotext.json` files.

## Go:Generate
[internal/translations/translations.go](../internal/translations/translations.go)

```go
package translations

import "golang.org/x/text/language"

//go:generate gotext -srclang=en update -out=catalog.go -lang=en,es,de,en-US,es-419 ../server/server.go


//..other code
```

the go:generate comment instructs gotext to source all the text formatted starting
from the [server.go](../internal/server/server.go), using the source language
(`-srclang`) of english we udpate the autogenerated [catalog.go](../internal/translations/catalog.go
) and `out.gotext.json` files for every discovered bit of formatted text for each
specfied locale.

```sh
$ go generate ./internal/translations/translations.go
de: Missing entry for "Welcome to".
es: Missing entry for "Welcome to".
```

example output

```sh
...
│ 
└── internal
    └── translations
        ├── catalog.go
        ├── locales
        │   ├── de
        │   │   └── out.gotext.json
        │   ├── en
        │   │   └── out.gotext.json
        │   └── es
        │       └── out.gotext.json
        └── translations.go
```

example of [de/out.gotext.json](../internal/translations/locales/de/out.gotext.json)

```json
{
    "language": "de",
    "messages": [
        {
            "id": "Welcome to",
            "message": "Welcome to",
            "translation": ""
        }
    ]
}
```

These messages can now be translated into their intended languages and placed
_back into the same directories_ as `messages.gotext.json` files. Example:
[de/messages.gotext.json](../internal/translations/locales/de/messages.gotext.json)

```json
{
    "language": "de",
    "messages": [
        {
            "id": "Welcome to",
            "message": "Welcome to",
            "translation": ""Willkommen bei"
        }
    ]
}
```

Now run `go generate` again:

```sh
$ go generate ./internal/translations/translations.go
# no missing messages output!
```

There should now be no missing messages errors (assuming all the messages were translated/populated).
